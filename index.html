<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flower Shop - –≠–ª–∏—Ç–Ω—ã–µ –±—É–∫–µ—Ç—ã</title>
    <script src="https://telegram.org/js/telegram-web-app.js?2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{
            --primary:#dc2626;--primary-dark:#b91c1c;--primary-light:#fecaca;
            --secondary:#ef4444;--secondary-dark:#dc2626;--accent:#dc2626;
            --accent-dark:#b91c1c;--text:#1f2937;--text-light:#6b7280;
            --text-lighter:#9ca3af;--bg:#ffffff;--bg-secondary:#f8fafc;
            --bg-tertiary:#f1f5f9;--card-bg:#ffffff;--shadow:0 4px 12px rgba(0,0,0,0.08);
            --shadow-lg:0 10px 25px rgba(0,0,0,0.12);--shadow-sm:0 1px 4px rgba(0,0,0,0.06);
            --border:1px solid #e5e7eb;--radius:16px;--radius-sm:10px;--radius-lg:20px;
            --header-bg:linear-gradient(135deg,#667eea 0%,#764ba2 100%)
        }
        body{
            font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            color:var(--text);min-height:100vh;line-height:1.5
        }
        .app-container{max-width:400px;margin:0 auto;background:var(--bg);min-height:100vh;position:relative;overflow-x:hidden}
        
        .header{background:var(--header-bg);color:white;padding:40px 20px 30px;text-align:center;position:relative;overflow:hidden}
        .header::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="flowers" x="0" y="0" width="30" height="30" patternUnits="userSpaceOnUse"><circle cx="15" cy="15" r="5" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23flowers)"/></svg>')}
        .header-content{position:relative;z-index:2}
        .header h1{font-size:28px;font-weight:800;margin-bottom:6px;text-shadow:0 2px 4px rgba(0,0,0,0.2)}
        .header p{font-size:14px;opacity:0.95;font-weight:500;margin-bottom:12px}
        .delivery-info{background:rgba(255,255,255,0.2);padding:10px 14px;border-radius:12px;font-size:13px;font-weight:600;backdrop-filter:blur(10px);margin-top:8px}
        
        .categories{display:flex;gap:6px;padding:16px;overflow-x:auto;background:var(--bg);border-bottom:var(--border)}
        .category-btn{padding:12px 18px;border:2px solid #e5e7eb;border-radius:16px;background:white;color:var(--text);font-weight:600;white-space:nowrap;cursor:pointer;transition:all 0.2s ease;font-size:13px;display:flex;align-items:center;gap:4px;flex-shrink:0}
        .category-btn.active{background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);color:white;border-color:var(--primary);box-shadow:var(--shadow-sm)}
        
        .products-grid{padding:16px;display:grid;gap:16px;padding-bottom:80px}
        .product-card{background:var(--card-bg);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);transition:all 0.3s ease;border:var(--border)}
        .product-card:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
        .product-image{width:100%;height:180px;background:linear-gradient(135deg,#ffe8e8 0%,#ffd6d6 100%);position:relative;overflow:hidden}
        .product-image img{width:100%;height:100%;object-fit:cover}
        .product-badge{position:absolute;top:10px;right:10px;background:linear-gradient(135deg,var(--secondary) 0%,var(--secondary-dark) 100%);color:white;padding:4px 10px;border-radius:10px;font-size:11px;font-weight:700}
        .product-content{padding:16px}
        .product-title{font-size:16px;font-weight:700;margin-bottom:6px;color:var(--text);line-height:1.3}
        .product-description{font-size:13px;color:var(--text-light);margin-bottom:10px;line-height:1.4}
        .product-fact{background:white;padding:10px 12px;border-radius:var(--radius-sm);margin-bottom:12px;border:2px solid var(--primary);display:flex;align-items:flex-start;cursor:pointer}
        .product-fact i{color:#f59e0b;margin-right:8px;transition:all 0.3s ease;flex-shrink:0;margin-top:2px}
        .product-fact:hover i{color:#fbbf24;text-shadow:0 0 10px #f59e0b,0 0 20px #f59e0b;transform:scale(1.1)}
        .product-fact-text{font-size:12px;color:var(--text);font-style:italic;line-height:1.4;flex:1}
        .product-footer{display:flex;justify-content:space-between;align-items:center}
        .product-price{font-size:18px;font-weight:800;color:var(--secondary)}
        .add-to-cart{background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);color:white;border:none;border-radius:16px;padding:12px 16px;font-weight:600;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:6px;font-size:13px;min-height:44px}
        .add-to-cart:hover{transform:scale(1.05)}
        
        .floating-buttons{position:fixed;bottom:16px;right:16px;display:flex;flex-direction:column;gap:8px;z-index:1000}
        .cart-button{background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);color:white;border:none;border-radius:40px;padding:14px 20px;font-size:14px;font-weight:700;cursor:pointer;box-shadow:var(--shadow-lg);display:none;align-items:center;gap:8px;transition:all 0.2s ease;min-height:44px}
        .cart-count{background:var(--secondary);color:white;border-radius:50%;width:22px;height:22px;font-size:12px;display:flex;align-items:center;justify-content:center;font-weight:800}
        .admin-button{background:linear-gradient(135deg,var(--accent) 0%,var(--accent-dark) 100%);color:white;border:none;border-radius:40px;padding:14px;font-size:16px;cursor:pointer;box-shadow:var(--shadow-lg);transition:all 0.2s ease;display:none;min-height:44px;min-width:44px;align-items:center;justify-content:center}
        .help-button{background:linear-gradient(135deg,#3b82f6 0%,#1d4ed8 100%);color:white;border:none;border-radius:40px;padding:14px;font-size:16px;cursor:pointer;box-shadow:var(--shadow-lg);transition:all 0.2s ease;display:flex;min-height:44px;min-width:44px;align-items:center;justify-content:center}
        
        .modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;z-index:2000;padding:16px;backdrop-filter:blur(5px)}
        .modal-content{background:white;border-radius:var(--radius-lg);padding:20px;max-width:360px;width:100%;max-height:80vh;overflow-y:auto;animation:modalSlideIn 0.3s ease;box-shadow:var(--shadow-lg)}
        @keyframes modalSlideIn{from{opacity:0;transform:translateY(30px)} to{opacity:1;transform:translateY(0)}}
        .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:12px;border-bottom:2px solid #f0f0f0}
        .modal-title{font-size:18px;font-weight:800;color:var(--text);display:flex;align-items:center;gap:6px}
        .close-modal{background:none;border:none;font-size:24px;cursor:pointer;color:var(--text-light);width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease;min-height:44px;min-width:44px}
        .close-modal:hover{background:#f0f0f0}
        
        .cart-items{margin-bottom:20px;max-height:250px;overflow-y:auto}
        .cart-item{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f0f0f0}
        .item-info{flex-grow:1}
        .item-name{font-weight:700;margin-bottom:2px;color:var(--text);font-size:14px}
        .item-price{color:var(--secondary);font-weight:700;font-size:14px}
        .item-actions{display:flex;align-items:center;gap:8px}
        .quantity-controls{display:flex;align-items:center;gap:6px;background:#f8f9fa;border-radius:16px;padding:3px;border:1px solid #e5e7eb}
        .quantity-btn{background:var(--primary);color:white;border:none;border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-weight:bold;font-size:14px;transition:all 0.2s ease;min-height:44px;min-width:44px}
        .quantity-btn:hover{background:var(--primary-dark)}
        .quantity{font-weight:700;min-width:24px;text-align:center;font-size:14px}
        .remove-item{background:#ef4444;color:white;border:none;border-radius:12px;padding:8px 12px;font-size:12px;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:4px;min-height:44px}
        .remove-item:hover{background:#dc2626}
        
        .cart-total{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-top:12px;border-top:2px solid #e5e7eb;font-size:18px;font-weight:800}
        .form-group{margin-bottom:16px}
        .form-label{display:block;margin-bottom:6px;font-weight:600;color:var(--text);font-size:14px}
        .form-input{width:100%;padding:12px;border:2px solid #e5e7eb;border-radius:12px;font-size:14px;transition:all 0.2s ease;font-weight:500;background:white;min-height:44px}
        .form-input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(220,38,38,0.1)}
        .phone-input{font-family:monospace;letter-spacing:1px}
        .checkout-btn{width:100%;background:linear-gradient(135deg,#10b981 0%,#059669 100%);color:white;border:none;border-radius:16px;padding:16px;font-size:15px;font-weight:700;cursor:pointer;transition:all 0.2s ease;margin-top:8px;box-shadow:var(--shadow);min-height:44px}
        .checkout-btn:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
        .checkout-btn:disabled{background:#9ca3af;cursor:not-allowed;transform:none;box-shadow:none}
        
        .empty-cart{text-align:center;padding:30px 16px;color:var(--text-light)}
        .empty-cart i{font-size:40px;color:#d1d5db;margin-bottom:12px}
        .success-state{text-align:center;padding:24px 16px}
        .success-icon{font-size:50px;color:#10b981;margin-bottom:16px}
        .success-title{font-size:20px;font-weight:800;margin-bottom:8px;color:var(--text)}
        .success-message{color:var(--text-light);margin-bottom:20px;line-height:1.4;font-size:14px}
        
        .loading{text-align:center;padding:30px 16px;color:var(--text-light)}
        .loading-spinner{border:3px solid #f3f3f3;border-top:3px solid var(--primary);border-radius:50%;width:32px;height:32px;animation:spin 1s linear infinite;margin:0 auto 16px}
        @keyframes spin{0%{transform:rotate(0deg)} 100%{transform:rotate(360deg)}}
        
        .admin-panel{display:none;background:var(--bg);min-height:100vh}
        .admin-header{background:linear-gradient(135deg,#4f46e5 0%,#7c3aed 100%);color:white;padding:18px 20px;display:flex;justify-content:space-between;align-items:center;border-bottom:var(--border)}
        .admin-title{font-size:18px;font-weight:700}
        .admin-switch{background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.3);color:white;padding:8px 14px;border-radius:12px;font-weight:600;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:6px;font-size:13px;min-height:44px}
        .admin-switch:hover{background:rgba(255,255,255,0.3)}
        
        .admin-tabs{display:flex;gap:6px;padding:12px;background:var(--bg-secondary);border-bottom:var(--border);overflow-x:auto}
        .admin-tab{padding:10px 14px;border:2px solid #e5e7eb;border-radius:12px;background:white;color:var(--text);font-weight:600;white-space:nowrap;cursor:pointer;transition:all 0.2s ease;font-size:12px;display:flex;align-items:center;gap:4px;flex-shrink:0;min-height:44px}
        .admin-tab.active{background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);color:white;border-color:var(--primary)}
        .admin-content{padding:16px}
        .admin-tab-content{display:none}
        .admin-tab-content.active{display:block}
        
        .stats-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px}
        .stat-card{background:white;padding:16px;border-radius:var(--radius);box-shadow:var(--shadow);text-align:center;border-left:3px solid var(--primary)}
        .stat-value{font-size:20px;font-weight:800;color:var(--primary);margin-bottom:4px}
        .stat-label{color:var(--text-light);font-size:11px;font-weight:600}
        
        .product-form{background:white;padding:16px;border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:16px;border:var(--border)}
        .form-title{font-size:16px;font-weight:700;margin-bottom:12px;color:var(--text);display:flex;align-items:center;gap:6px;cursor:pointer}
        .form-title i{transition:transform 0.2s ease}
        .form-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px}
        .form-full{grid-column:1/-1}
        .form-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
        .collapsible-content{max-height:0;overflow:hidden;transition:max-height 0.3s ease}
        .collapsible-content.expanded{max-height:500px}
        
        .search-box{background:white;padding:12px;border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:12px;border:var(--border)}
        .search-input{width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:10px;font-size:13px;min-height:44px}
        .search-input:focus{outline:none;border-color:var(--primary)}
        
        .filter-buttons{display:flex;gap:6px;margin-top:8px;overflow-x:auto}
        .filter-btn{padding:8px 12px;border:2px solid #e5e7eb;border-radius:10px;background:white;color:var(--text);font-weight:600;cursor:pointer;white-space:nowrap;font-size:11px;transition:all 0.2s ease;flex-shrink:0;min-height:44px}
        .filter-btn.active{background:var(--primary);color:white;border-color:var(--primary)}
        
        .admin-table{background:white;border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);margin-bottom:16px;border:var(--border)}
        .table-header{padding:12px 16px;background:#f8fafc;border-bottom:1px solid #e5e7eb;font-weight:700;display:grid;gap:8px;font-size:12px;color:var(--text)}
        .table-row{padding:12px 16px;border-bottom:1px solid #f0f0f0;display:grid;gap:8px;align-items:center;font-size:12px;color:var(--text-light);transition:all 0.2s ease}
        .table-row:hover{background:#f8f9fa}
        .table-row:last-child{border-bottom:none}
        
        .status-badge{padding:6px 10px;border-radius:8px;font-size:10px;font-weight:600;text-align:center}
        .btn{padding:10px 14px;border:none;border-radius:8px;cursor:pointer;font-weight:600;font-size:12px;transition:all 0.2s ease;display:inline-flex;align-items:center;gap:4px;min-height:44px}
        .btn:hover{transform:translateY(-1px)}
        .btn-primary{background:linear-gradient(135deg,#10b981 0%,#059669 100%);color:white}
        .btn-secondary{background:#6b7280;color:white}
        .btn-danger{background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%);color:white}
        .btn-sm{padding:8px 12px;font-size:11px}
        .btn-lg{padding:12px 18px;font-size:14px}
        
        .toast{position:fixed;top:16px;left:50%;transform:translateX(-50%) translateY(-80px);color:white;padding:12px 18px;border-radius:20px;box-shadow:var(--shadow-lg);z-index:3000;transition:all 0.3s ease;font-weight:600;display:flex;align-items:center;gap:8px;opacity:0;backdrop-filter:blur(10px);font-size:14px}
        .toast.show{transform:translateX(-50%) translateY(0);opacity:1}
        .toast.success{background:linear-gradient(135deg,#10b981 0%,#059669 100%)}
        .toast.error{background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%)}
        .toast.info{background:linear-gradient(135deg,#3b82f6 0%,#1d4ed8 100%)}
        
        .delivery-banner{background:linear-gradient(135deg,var(--primary-light) 0%,#dbeafe 100%);padding:12px 16px;margin:0 16px 16px;border-radius:var(--radius);border-left:3px solid var(--primary);display:flex;align-items:center;gap:8px;font-weight:600;color:var(--text);font-size:13px}
        .delivery-banner i{color:var(--primary);font-size:16px}
        
        .badge{display:inline-flex;align-items:center;gap:2px;padding:4px 8px;border-radius:6px;font-size:10px;font-weight:700;text-transform:uppercase}
        .badge.new{background:#fef3c7;color:#92400e}
        .badge.confirmed{background:#dbeafe;color:#1e40af}
        .badge.delivered{background:#dcfce7;color:#166534}
        .badge.cancelled{background:#fecaca;color:#991b1b}
        
        .empty-table-message{grid-column:1/-1;text-align:center;padding:30px 16px;color:var(--text-light);font-size:14px}
        .role-badge{padding:6px 10px;border-radius:6px;font-size:10px;font-weight:700;text-transform:uppercase}
        .role-owner{background:#fee2e2;color:#dc2626}
        .role-admin{background:#dbeafe;color:#1d4ed8}
        
        .settings-group{margin-bottom:16px}
        .settings-label{font-weight:600;margin-bottom:6px;color:var(--text);font-size:14px}
        .settings-hint{font-size:12px;color:var(--text-light);margin-top:4px}
        .checkbox-group{display:flex;align-items:center;gap:8px;margin-bottom:12px}
        .checkbox-label{font-weight:600;color:var(--text);font-size:14px}
        
        .delivery-option{background:white;border:2px solid #e5e7eb;border-radius:12px;padding:12px;margin-bottom:12px;cursor:pointer;transition:all 0.2s ease;min-height:44px}
        .delivery-option.selected{border-color:var(--primary);background:var(--primary-light)}
        .delivery-option-header{display:flex;align-items:center;gap:8px;margin-bottom:8px}
        .delivery-option-title{font-weight:700;font-size:14px}
        .delivery-option-description{font-size:12px;color:var(--text-light)}
        .delivery-price{font-weight:700;color:var(--secondary);font-size:14px}
        
        .admin-actions{display:flex;gap:6px;flex-wrap:wrap}
        .contact-btn{background:linear-gradient(135deg,#3b82f6 0%,#1d4ed8 100%);color:white;border:none;border-radius:6px;padding:8px 12px;font-size:11px;cursor:pointer;display:flex;align-items:center;gap:4px;min-height:44px}
        
        .settings-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px}
        .settings-full{grid-column:1/-1}
        .settings-input{width:100%;padding:12px;border:2px solid #e5e7eb;border-radius:10px;font-size:13px;min-height:44px}
        .settings-input:focus{outline:none;border-color:var(--primary)}
        
        .theme-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px}
        .theme-option{height:80px;border-radius:12px;cursor:pointer;border:3px solid transparent;transition:all 0.2s ease;position:relative}
        .theme-option.selected{border-color:var(--primary)}
        .theme-option::after{content:'‚úì';position:absolute;top:8px;right:8px;background:var(--primary);color:white;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:bold;opacity:0;transition:opacity 0.2s ease}
        .theme-option.selected::after{opacity:1}
        
        .help-section{display:none}
        .help-section.active{display:block}
        .help-tabs{display:flex;gap:6px;padding:12px;background:var(--bg-secondary);border-bottom:var(--border);overflow-x:auto}
        .help-tab{padding:10px 14px;border:2px solid #e5e7eb;border-radius:12px;background:white;color:var(--text);font-weight:600;white-space:nowrap;cursor:pointer;transition:all 0.2s ease;font-size:12px;flex-shrink:0;min-height:44px}
        .help-tab.active{background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);color:white;border-color:var(--primary)}
        .help-content{padding:16px}
        .help-item{margin-bottom:20px}
        .help-item h3{font-size:16px;font-weight:700;margin-bottom:8px;color:var(--text)}
        .help-item p{font-size:14px;color:var(--text-light);line-height:1.5;margin-bottom:8px}
        .help-item ul{margin-left:20px;color:var(--text-light)}
        .help-item li{font-size:14px;margin-bottom:4px;line-height:1.4}
        
        .order-summary{background:#f8f9fa;padding:16px;border-radius:var(--radius);margin-bottom:16px;border:var(--border)}
        .summary-row{display:flex;justify-content:space-between;margin-bottom:8px;font-size:14px}
        .summary-row.total{font-weight:700;font-size:16px;border-top:1px solid #e5e7eb;padding-top:8px;margin-top:8px}
        
        .sortable-handle{cursor:grab;padding:8px;color:var(--text-light);min-height:44px;min-width:44px;display:flex;align-items:center;justify-content:center}
        .sortable-handle:active{cursor:grabbing}
        .sortable-ghost{opacity:0.4}
        
        .table-header.products-header{grid-template-columns:50px 1fr 80px 80px 120px}
        .table-header.orders-header{grid-template-columns:60px 1fr 80px 80px 140px}
        .table-header.admins-header{grid-template-columns:60px 1fr 1fr 80px 100px}
        .table-header.promocodes-header{grid-template-columns:1fr 80px 80px 80px 100px}
        
        .quick-actions{display:flex;gap:8px;padding:12px 16px;background:var(--bg-secondary);border-bottom:var(--border);overflow-x:auto}
        .quick-action-btn{padding:12px 16px;background:white;border:var(--border);border-radius:12px;color:var(--text);font-weight:600;white-space:nowrap;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:6px;font-size:13px;flex-shrink:0;min-height:44px}
        .quick-action-btn:hover{background:var(--primary-light);border-color:var(--primary)}
        .quick-action-btn.primary{background:var(--primary);color:white;border-color:var(--primary)}
        
        .help-view{display:none;background:var(--bg);min-height:100vh}
        .help-header{background:linear-gradient(135deg,var(--accent) 0%,var(--accent-dark) 100%);color:white;padding:18px 20px;display:flex;justify-content:space-between;align-items:center;border-bottom:var(--border)}
        .help-title{font-size:18px;font-weight:700}
        .help-back{background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.3);color:white;padding:8px 14px;border-radius:12px;font-weight:600;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:6px;font-size:13px;min-height:44px}
        .help-back:hover{background:rgba(255,255,255,0.3)}
        
        .pagination{display:flex;justify-content:center;gap:8px;margin-top:16px}
        .page-btn{padding:10px 14px;border:1px solid #e5e7eb;border-radius:8px;background:white;color:var(--text);cursor:pointer;font-size:12px;font-weight:600;min-height:44px}
        .page-btn.active{background:var(--primary);color:white;border-color:var(--primary)}
        .page-btn:disabled{opacity:0.5;cursor:not-allowed}
        
        .dangerous-section{background:linear-gradient(135deg,#fee2e2 0%,#fecaca 100%);border:2px solid #fca5a5;border-radius:var(--radius);padding:16px;margin-bottom:16px}
        .dangerous-title{color:#dc2626;font-size:16px;font-weight:700;margin-bottom:8px;display:flex;align-items:center;gap:6px}
        .dangerous-description{color:#991b1b;font-size:13px;margin-bottom:12px}
        .dangerous-input{width:100%;padding:12px;border:2px solid #fca5a5;border-radius:10px;font-size:13px;margin-bottom:12px;min-height:44px}
        .dangerous-btn{background:linear-gradient(135deg,#dc2626 0%,#b91c1c 100%);color:white;border:none;border-radius:10px;padding:12px 16px;font-weight:700;cursor:pointer;transition:all 0.2s ease;min-height:44px}
        .dangerous-btn:hover{transform:translateY(-2px)}
        
        .promo-form{background:white;padding:16px;border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:16px;border:var(--border)}
        .promo-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px}
        .promo-full{grid-column:1/-1}
        
        .move-buttons{display:flex;gap:4px}
        .move-btn{padding:6px;border:1px solid #e5e7eb;border-radius:6px;background:white;cursor:pointer;color:var(--text-light);min-height:44px;min-width:44px;display:flex;align-items:center;justify-content:center}
        .move-btn:hover{background:#f8f9fa}
        
        .promo-field{display:flex;align-items:center;gap:8px}
        .promo-discount{display:flex;align-items:center;gap:4px}
    </style>
</head>
<body>
    <div class="app-container">
        <div class="toast" id="toast">
            <i class="fas fa-check-circle" id="toastIcon"></i>
            <span id="toastMessage">–î–æ–±–∞–≤–ª–µ–Ω–æ</span>
        </div>

        <div class="customer-view" id="customerView">
            <div class="header" id="shopHeader">
                <div class="header-content">
                    <h1 id="shopName">üå∏ Flower Shop</h1>
                    <p>–≠–ª–∏—Ç–Ω—ã–µ –±—É–∫–µ—Ç—ã —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π –ø–æ –Ø—Ä–æ—Å–ª–∞–≤–ª—é</p>
                    <div class="delivery-info">
                        <i class="fas fa-shipping-fast"></i>
                        <span id="deliveryInfoText">–î–æ—Å—Ç–∞–≤–∫–∞ 200‚ÇΩ ‚Ä¢ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –æ—Ç 3000‚ÇΩ</span>
                    </div>
                </div>
            </div>

            <div class="delivery-banner">
                <i class="fas fa-clock"></i>
                <span id="workingHoursText">–î–æ—Å—Ç–∞–≤–ª—è–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω–æ —Å 9:00 –¥–æ 21:00</span>
            </div>

            <div class="categories">
                <button class="category-btn active" onclick="filterByCategory('all')">
                    <i class="fas fa-star"></i>–í—Å–µ —Ç–æ–≤–∞—Ä—ã
                </button>
                <button class="category-btn" onclick="filterByCategory('roses')">
                    <i class="fas fa-heart"></i>–†–æ–∑—ã
                </button>
                <button class="category-btn" onclick="filterByCategory('tulips')">
                    <i class="fas fa-sun"></i>–¢—é–ª—å–ø–∞–Ω—ã
                </button>
                <button class="category-btn" onclick="filterByCategory('orchids')">
                    <i class="fas fa-spa"></i>–û—Ä—Ö–∏–¥–µ–∏
                </button>
                <button class="category-btn" onclick="filterByCategory('premium')">
                    <i class="fas fa-crown"></i>–ü—Ä–µ–º–∏—É–º
                </button>
            </div>

            <div class="products-grid" id="productsGrid">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div>–ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–∞–ª–æ–≥...</div>
                </div>
            </div>
        </div>

        <div class="admin-panel" id="adminPanel">
            <div class="admin-header">
                <div class="admin-title">üõ†Ô∏è –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
                <button class="admin-switch" onclick="switchToCustomerView()">
                    <i class="fas fa-store"></i> –ú–∞–≥–∞–∑–∏–Ω
                </button>
            </div>

            <div class="admin-tabs">
                <div class="admin-tab active" data-tab="dashboard">
                    <i class="fas fa-chart-bar"></i>–ì–ª–∞–≤–Ω–∞—è
                </div>
                <div class="admin-tab" data-tab="products">
                    <i class="fas fa-shopping-bag"></i>–¢–æ–≤–∞—Ä—ã
                </div>
                <div class="admin-tab" data-tab="orders">
                    <i class="fas fa-clipboard-list"></i>–ó–∞–∫–∞–∑—ã
                </div>
                <div class="admin-tab" data-tab="promocodes">
                    <i class="fas fa-tag"></i>–ü—Ä–æ–º–æ–∫–æ–¥—ã
                </div>
                <div class="admin-tab" data-tab="admins">
                    <i class="fas fa-users"></i>–ê–¥–º–∏–Ω—ã
                </div>
                <div class="admin-tab" data-tab="settings">
                    <i class="fas fa-cog"></i>–ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </div>
                <div class="admin-tab" data-tab="help">
                    <i class="fas fa-question-circle"></i>–ü–æ–º–æ—â—å
                </div>
                <div class="admin-tab" data-tab="dangerous" id="dangerousTab" style="display:none">
                    <i class="fas fa-skull-crossbones"></i>–û–ø–∞—Å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
                </div>
            </div>

            <div class="admin-content">
                <div class="admin-tab-content active" id="dashboardTab">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="totalOrders">0</div>
                            <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="completedOrders">0</div>
                            <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalRevenue">0 ‚ÇΩ</div>
                            <div class="stat-label">–†–µ–∞–ª—å–Ω–∞—è –≤—ã—Ä—É—á–∫–∞</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="potentialRevenue">0 ‚ÇΩ</div>
                            <div class="stat-label">–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalProducts">0</div>
                            <div class="stat-label">–¢–æ–≤–∞—Ä–æ–≤</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="activePromocodes">0</div>
                            <div class="stat-label">–ü—Ä–æ–º–æ–∫–æ–¥–æ–≤</div>
                        </div>
                    </div>

                    <div class="quick-actions">
                        <button class="quick-action-btn primary" onclick="loadAdminData()">
                            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                        <button class="quick-action-btn" onclick="showTab('products')">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                        </button>
                        <button class="quick-action-btn" onclick="showTab('orders')">
                            <i class="fas fa-eye"></i> –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤
                        </button>
                    </div>
                </div>

                <div class="admin-tab-content" id="productsTab">
                    <div class="product-form">
                        <div class="form-title" onclick="toggleProductForm()">
                            <i class="fas fa-chevron-down" id="productFormIcon"></i>
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä
                        </div>
                        <div class="collapsible-content" id="productFormContent">
                            <div class="form-row">
                                <input type="text" id="productName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" class="form-input">
                                <input type="number" id="productPrice" placeholder="–¶–µ–Ω–∞ –≤ —Ä—É–±–ª—è—Ö" class="form-input">
                            </div>
                            <div class="form-row">
                                <input type="text" id="productImage" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" class="form-input">
                                <select id="productCategory" class="form-input">
                                    <option value="roses">–†–æ–∑—ã</option>
                                    <option value="tulips">–¢—é–ª—å–ø–∞–Ω—ã</option>
                                    <option value="orchids">–û—Ä—Ö–∏–¥–µ–∏</option>
                                    <option value="premium">–ü—Ä–µ–º–∏—É–º –±—É–∫–µ—Ç—ã</option>
                                </select>
                            </div>
                            <div class="form-row form-full">
                                <textarea id="productDescription" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" class="form-input" rows="2"></textarea>
                            </div>
                            <div class="form-row form-full">
                                <textarea id="productFact" placeholder="–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç –æ —Ü–≤–µ—Ç–∞—Ö" class="form-input" rows="2"></textarea>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="productFeatured">
                                <label class="checkbox-label">–•–∏—Ç —Ç–æ–≤–∞—Ä (–±–µ–π–¥–∂ "–•–∏—Ç")</label>
                            </div>
                            <div class="form-actions">
                                <button class="btn btn-primary btn-lg" onclick="addProduct()">
                                    <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä
                                </button>
                                <button class="btn btn-secondary" onclick="resetProductForm()">
                                    <i class="fas fa-times"></i> –û—á–∏—Å—Ç–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="search-box">
                        <input type="text" id="productSearch" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –æ–ø–∏—Å–∞–Ω–∏—é –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏..." class="search-input" onkeyup="filterProducts()">
                    </div>

                    <div class="admin-table">
                        <div class="table-header products-header">
                            <div></div>
                            <div>–¢–æ–≤–∞—Ä</div>
                            <div>–¶–µ–Ω–∞</div>
                            <div>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</div>
                            <div>–î–µ–π—Å—Ç–≤–∏—è</div>
                        </div>
                        <div id="productsList"></div>
                    </div>
                </div>

                <div class="admin-tab-content" id="ordersTab">
                    <div class="search-box">
                        <input type="text" id="orderSearch" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ ID, –∏–º–µ–Ω–∏ –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω—É..." class="search-input" onkeyup="filterOrders()">
                        <div class="filter-buttons">
                            <button class="filter-btn active" data-status="all">–í—Å–µ –∑–∞–∫–∞–∑—ã</button>
                            <button class="filter-btn" data-status="1">–ù–æ–≤—ã–µ</button>
                            <button class="filter-btn" data-status="2">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã</button>
                            <button class="filter-btn" data-status="3">–°–æ–±–∏—Ä–∞—é—Ç—Å—è</button>
                            <button class="filter-btn" data-status="4">–í –ø—É—Ç–∏</button>
                            <button class="filter-btn" data-status="5">–î–æ—Å—Ç–∞–≤–ª–µ–Ω—ã</button>
                            <button class="filter-btn" data-status="6">–û—Ç–º–µ–Ω–µ–Ω—ã</button>
                        </div>
                    </div>

                    <div class="admin-table">
                        <div class="table-header orders-header">
                            <div>ID</div>
                            <div>–ö–ª–∏–µ–Ω—Ç</div>
                            <div>–°—É–º–º–∞</div>
                            <div>–°—Ç–∞—Ç—É—Å</div>
                            <div>–î–µ–π—Å—Ç–≤–∏—è</div>
                        </div>
                        <div id="ordersList"></div>
                    </div>
                    
                    <div class="pagination" id="ordersPagination"></div>
                </div>

                <div class="admin-tab-content" id="promocodesTab">
                    <div class="promo-form" id="promoFormContainer" style="display:none">
                        <div class="form-title">üè∑Ô∏è –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</div>
                        <div class="promo-row">
                            <input type="text" id="promoCode" placeholder="–ö–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞" class="form-input">
                            <select id="promoDiscountType" class="form-input">
                                <option value="percentage">–ü—Ä–æ—Ü–µ–Ω—Ç</option>
                                <option value="fixed">–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è</option>
                            </select>
                        </div>
                        <div class="promo-row">
                            <div class="promo-field">
                                <input type="number" id="promoDiscountValue" placeholder="–ó–Ω–∞—á–µ–Ω–∏–µ" class="form-input">
                                <span id="promoDiscountSuffix">%</span>
                            </div>
                            <input type="number" id="promoMinOrder" placeholder="–ú–∏–Ω. —Å—É–º–º–∞" class="form-input">
                        </div>
                        <div class="promo-row">
                            <input type="number" id="promoMaxUses" placeholder="–õ–∏–º–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π" class="form-input">
                            <input type="date" id="promoValidUntil" class="form-input">
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="addPromocode()">
                                <i class="fas fa-tag"></i> –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
                            </button>
                            <button class="btn btn-secondary" onclick="resetPromoForm()">
                                <i class="fas fa-times"></i> –û—á–∏—Å—Ç–∏—Ç—å
                            </button>
                        </div>
                    </div>

                    <div class="admin-table">
                        <div class="table-header promocodes-header">
                            <div>–ö–æ–¥</div>
                            <div>–°–∫–∏–¥–∫–∞</div>
                            <div>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</div>
                            <div>–°—Ç–∞—Ç—É—Å</div>
                            <div>–î–µ–π—Å—Ç–≤–∏—è</div>
                        </div>
                        <div id="promocodesList"></div>
                    </div>
                </div>

                <div class="admin-tab-content" id="adminsTab">
                    <div class="product-form" id="adminFormContainer" style="display:none">
                        <div class="form-title">üë§ –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</div>
                        <div class="form-row">
                            <input type="text" id="adminTelegramId" placeholder="Telegram ID" class="form-input">
                            <input type="text" id="adminUsername" placeholder="Username (@nickname)" class="form-input">
                        </div>
                        <div class="form-row">
                            <input type="text" id="adminFirstName" placeholder="–ò–º—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" class="form-input">
                            <select id="adminRole" class="form-input">
                                <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                                <option value="owner">–í–ª–∞–¥–µ–ª–µ—Ü</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="addAdmin()">
                                <i class="fas fa-user-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                            </button>
                            <button class="btn btn-secondary" onclick="resetAdminForm()">
                                <i class="fas fa-times"></i> –û—á–∏—Å—Ç–∏—Ç—å
                            </button>
                        </div>
                    </div>

                    <div class="admin-table">
                        <div class="table-header admins-header">
                            <div>ID</div>
                            <div>–ò–º—è</div>
                            <div>Username</div>
                            <div>–†–æ–ª—å</div>
                            <div>–î–µ–π—Å—Ç–≤–∏—è</div>
                        </div>
                        <div id="adminsList"></div>
                    </div>
                </div>

                <div class="admin-tab-content" id="settingsTab">
                    <div class="product-form">
                        <div class="form-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞</div>
                        
                        <div class="settings-group">
                            <div class="settings-label">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                            <div class="settings-row">
                                <input type="text" id="shopNameInput" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞" class="settings-input">
                                <input type="text" id="shopPhone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" class="settings-input">
                            </div>
                            <div class="settings-full">
                                <input type="text" id="shopAddress" placeholder="–ê–¥—Ä–µ—Å –º–∞–≥–∞–∑–∏–Ω–∞" class="settings-input">
                            </div>
                            <div class="settings-full">
                                <textarea id="shopWorkingHours" placeholder="–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã" class="settings-input" rows="2"></textarea>
                            </div>
                        </div>

                        <div class="settings-group">
                            <div class="settings-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏</div>
                            <div class="settings-row">
                                <input type="number" id="deliveryPrice" placeholder="–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏" class="settings-input">
                                <input type="number" id="freeDeliveryMin" placeholder="–ë–µ—Å–ø–ª–∞—Ç–Ω–æ –æ—Ç —Å—É–º–º—ã" class="settings-input">
                            </div>
                        </div>

                        <div class="settings-group">
                            <div class="settings-label">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞</div>
                            <div class="theme-grid" id="themeGrid"></div>
                        </div>

                        <div class="form-actions">
                            <button class="btn btn-primary btn-lg" onclick="saveShopSettings()">
                                <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                            </button>
                        </div>
                    </div>
                </div>

                <div class="admin-tab-content" id="helpTab">
                    <div class="help-content">
                        <div class="help-item">
                            <h3>üìñ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –±–æ—Ç–æ–º</h3>
                            <p>–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–∞—à–∏–º —Ü–≤–µ—Ç–æ—á–Ω—ã–º –º–∞–≥–∞–∑–∏–Ω–æ–º —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞.</p>
                        </div>

                        <div class="help-item">
                            <h3>üõçÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h3>
                            <p><strong>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤:</strong></p>
                            <ul>
                                <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–¢–æ–≤–∞—Ä—ã"</li>
                                <li>–ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä"</li>
                                <li>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è</li>
                                <li>–£–∫–∞–∂–∏—Ç–µ —Ü–µ–Ω—É, –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</li>
                            </ul>
                            <p><strong>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ ‚Üë –∏ ‚Üì –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤</p>
                        </div>

                        <div class="help-item">
                            <h3>üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</h3>
                            <p><strong>–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤:</strong></p>
                            <ul>
                                <li>–í—Å–µ –∑–∞–∫–∞–∑—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–ó–∞–∫–∞–∑—ã"</li>
                                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</li>
                                <li>–ü–æ–∏—Å–∫ –ø–æ ID, –∏–º–µ–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω—É</li>
                            </ul>
                            <p><strong>–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤:</strong> –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ –¥–ª—è –µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</p>
                        </div>

                        <div class="help-item">
                            <h3>üè∑Ô∏è –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤</h3>
                            <p><strong>–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤:</strong></p>
                            <ul>
                                <li>–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤</li>
                                <li>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–∏–ø —Å–∫–∏–¥–∫–∏ (–ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è –∏–ª–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)</li>
                                <li>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–∏–º–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π –∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è</li>
                            </ul>
                            <p><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤:</strong> –ö–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –≤–≤–æ–¥–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥—ã –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞</p>
                        </div>

                        <div class="help-item">
                            <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞</h3>
                            <p><strong>–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:</strong></p>
                            <ul>
                                <li>–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ –∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</li>
                                <li>–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —É—Å–ª–æ–≤–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏</li>
                                <li>–í—ã–±–æ—Ä —Ç–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</li>
                            </ul>
                        </div>

                        <div class="help-item">
                            <h3>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏</h3>
                            <p><strong>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:</strong></p>
                            <ul>
                                <li>–¢–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü—ã –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤</li>
                                <li>–£–∫–∞–∂–∏—Ç–µ Telegram ID –∏ –∏–º—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</li>
                                <li>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å: –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–ª–∏ –≤–ª–∞–¥–µ–ª–µ—Ü</li>
                            </ul>
                        </div>

                        <div class="help-item">
                            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h3>
                            <p><strong>–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:</strong></p>
                            <ul>
                                <li>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∏ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</li>
                                <li>–†–µ–∞–ª—å–Ω–∞—è –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –≤—ã—Ä—É—á–∫–∞</li>
                                <li>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤</li>
                            </ul>
                        </div>

                        <div class="help-item">
                            <h3>‚ö†Ô∏è –û–ø–∞—Å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                            <p><strong>–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤:</strong></p>
                            <ul>
                                <li>–£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤</li>
                                <li>–°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</li>
                                <li>–£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤</li>
                            </ul>
                            <p>–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–≤–æ–¥ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.</p>
                        </div>
                    </div>
                </div>

                <div class="admin-tab-content" id="dangerousTab">
                    <div class="dangerous-section">
                        <div class="dangerous-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤
                        </div>
                        <div class="dangerous-description">
                            –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç –≤—Å–µ –∑–∞–∫–∞–∑—ã –∏–∑ —Å–∏—Å—Ç–µ–º—ã. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.
                        </div>
                        <input type="text" class="dangerous-input" id="deleteOrdersCode" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è DELETE_ORDERS">
                        <button class="dangerous-btn" onclick="dangerousAction('reset_orders')">
                            <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã
                        </button>
                    </div>

                    <div class="dangerous-section">
                        <div class="dangerous-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                        </div>
                        <div class="dangerous-description">
                            –û–±–Ω—É–ª–∏—Ç –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—ã—Ä—É—á–∫–∏ –∏ –ø—Ä–∏–±—ã–ª–∏. –ó–∞–∫–∞–∑—ã –æ—Å—Ç–∞–Ω—É—Ç—Å—è, –Ω–æ –∏—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç —Å–±—Ä–æ—à–µ–Ω—ã.
                        </div>
                        <input type="text" class="dangerous-input" id="resetStatsCode" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è RESET_STATS">
                        <button class="dangerous-btn" onclick="dangerousAction('reset_stats')">
                            <i class="fas fa-chart-line"></i> –°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                        </button>
                    </div>

                    <div class="dangerous-section">
                        <div class="dangerous-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
                        </div>
                        <div class="dangerous-description">
                            –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç –≤—Å–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã –∏–∑ —Å–∏—Å—Ç–µ–º—ã. –î–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.
                        </div>
                        <input type="text" class="dangerous-input" id="deletePromocodesCode" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è DELETE_PROMOCODES">
                        <button class="dangerous-btn" onclick="dangerousAction('delete_promocodes')">
                            <i class="fas fa-tags"></i> –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="help-view" id="helpView">
            <div class="help-header">
                <div class="help-title">‚ùì –ü–æ–º–æ—â—å –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</div>
                <button class="help-back" onclick="switchToCustomerView()">
                    <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥ –≤ –º–∞–≥–∞–∑–∏–Ω
                </button>
            </div>

            <div class="help-tabs">
                <div class="help-tab active" data-help="ordering">üõçÔ∏è –ö–∞–∫ –∑–∞–∫–∞–∑–∞—Ç—å</div>
                <div class="help-tab" data-help="delivery">üöö –î–æ—Å—Ç–∞–≤–∫–∞</div>
                <div class="help-tab" data-help="payment">üí≥ –û–ø–ª–∞—Ç–∞</div>
                <div class="help-tab" data-help="contacts">üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</div>
            </div>

            <div class="help-content">
                <div class="help-section active" id="orderingHelp">
                    <div class="help-item">
                        <h3>–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑</h3>
                        <p>–ü—Ä–æ—Ü–µ—Å—Å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –ø—Ä–æ—Å—Ç –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–µ–Ω:</p>
                        <ul>
                            <li>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞</li>
                            <li>–î–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ –∫–æ—Ä–∑–∏–Ω—É, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É "–í –∫–æ—Ä–∑–∏–Ω—É"</li>
                            <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–æ—Ä–∑–∏–Ω—É, –Ω–∞–∂–∞–≤ –Ω–∞ –ø–ª–∞–≤–∞—é—â—É—é –∫–Ω–æ–ø–∫—É –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É</li>
                            <li>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è: –¥–æ—Å—Ç–∞–≤–∫–∞ –∏–ª–∏ —Å–∞–º–æ–≤—ã–≤–æ–∑</li>
                            <li>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–∞–∫–∞–∑</li>
                        </ul>
                    </div>
                    
                    <div class="help-item">
                        <h3>–ö–æ—Ä–∑–∏–Ω–∞ —Ç–æ–≤–∞—Ä–æ–≤</h3>
                        <p>–í –∫–æ—Ä–∑–∏–Ω–µ –≤—ã –º–æ–∂–µ—Ç–µ:</p>
                        <ul>
                            <li>–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</li>
                            <li>–ò–∑–º–µ–Ω—è—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞</li>
                            <li>–£–¥–∞–ª—è—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏</li>
                            <li>–í–∏–¥–µ—Ç—å –∏—Ç–æ–≥–æ–≤—É—é —Å—É–º–º—É –∑–∞–∫–∞–∑–∞</li>
                        </ul>
                    </div>
                </div>

                <div class="help-section" id="deliveryHelp">
                    <div class="help-item">
                        <h3>–£—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏</h3>
                        <p>–ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞:</p>
                        <ul>
                            <li><strong>–î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º</strong> - –ø—Ä–∏–≤–µ–∑–µ–º –∑–∞–∫–∞–∑ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∞–¥—Ä–µ—Å—É –≤ –Ø—Ä–æ—Å–ª–∞–≤–ª–µ</li>
                            <li><strong>–°–∞–º–æ–≤—ã–≤–æ–∑</strong> - –∑–∞–±–µ—Ä–µ—Ç–µ –∑–∞–∫–∞–∑ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏–∑ –Ω–∞—à–µ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞</li>
                        </ul>
                    </div>
                    
                    <div class="help-item">
                        <h3>–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏</h3>
                        <p>–î–æ—Å—Ç–∞–≤–∫–∞ —Å—Ç–æ–∏—Ç 200 —Ä—É–±–ª–µ–π. –ü—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç 3000 —Ä—É–±–ª–µ–π - –¥–æ—Å—Ç–∞–≤–∫–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è.</p>
                        <p>–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ —Å 9:00 –¥–æ 21:00</p>
                    </div>
                </div>

                <div class="help-section" id="paymentHelp">
                    <div class="help-item">
                        <h3>–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã</h3>
                        <p>–ú—ã –ø—Ä–∏–Ω–∏–º–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã:</p>
                        <ul>
                            <li>–ù–∞–ª–∏—á–Ω—ã–º–∏ –∫—É—Ä—å–µ—Ä—É –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</li>
                            <li>–ë–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç–æ–π —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª</li>
                            <li>–û–Ω–ª–∞–π–Ω-–ø–µ—Ä–µ–≤–æ–¥–æ–º –ø–æ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–µ</li>
                        </ul>
                    </div>
                    
                    <div class="help-item">
                        <h3>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
                        <p>–ü–æ—Å–ª–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –Ω–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã.</p>
                    </div>
                </div>

                <div class="help-section" id="contactsHelp">
                    <div class="help-item">
                        <h3>–ù–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                        <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> +7 (999) 123-45-67</p>
                        <p><strong>–ê–¥—Ä–µ—Å:</strong> –Ø—Ä–æ—Å–ª–∞–≤–ª—å, —É–ª. –¶–≤–µ—Ç–æ—á–Ω–∞—è, 15</p>
                        <p><strong>–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:</strong> –ï–∂–µ–¥–Ω–µ–≤–Ω–æ —Å 9:00 –¥–æ 21:00</p>
                        <p><strong>–ü–æ–¥–¥–µ—Ä–∂–∫–∞:</strong> <a href="https://t.me/Fallout_RTG" style="color: var(--primary); text-decoration: none; font-weight: 600;">–Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ Telegram</a></p>
                    </div>
                    
                    <div class="help-item">
                        <h3>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</h3>
                        <p>–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–∞–±–æ—Ç–æ–π –±–æ—Ç–∞ –∏–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∑–∞–∫–∞–∑—É, –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ Telegram: @Fallout_RTG</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="floating-buttons">
        <button class="cart-button" id="cartButton" onclick="showCartModal()">
            <i class="fas fa-shopping-bag"></i>
            <span id="cartTotalAmount">0 ‚ÇΩ</span>
            <span class="cart-count" id="cartCount">0</span>
        </button>
        <button class="admin-button" onclick="switchToAdminView()" title="–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è" id="adminButton">
            <i class="fas fa-cog"></i>
        </button>
        <button class="help-button" onclick="showHelp()" title="–ü–æ–º–æ—â—å" id="helpButton">
            <i class="fas fa-question"></i>
        </button>
    </div>

    <div class="modal" id="cartModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title"><i class="fas fa-shopping-cart"></i> –ö–æ—Ä–∑–∏–Ω–∞ —Ç–æ–≤–∞—Ä–æ–≤</div>
                <button class="close-modal" id="closeCart">√ó</button>
            </div>
            <div class="cart-items" id="cartItems"></div>
            <div class="cart-total">
                <span>–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞:</span>
                <span id="modalTotal">0 ‚ÇΩ</span>
            </div>
            <button class="checkout-btn" id="checkoutBtn" onclick="showOrderModal()">
                <i class="fas fa-receipt"></i> –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é
            </button>
        </div>
    </div>

    <div class="modal" id="orderModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title"><i class="fas fa-file-invoice"></i> –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</div>
                <button class="close-modal" id="closeOrder">√ó</button>
            </div>
            
            <div id="orderForm">
                <div class="order-summary">
                    <h3 style="margin-bottom:12px">–î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞</h3>
                    <div id="orderSummaryContent"></div>
                </div>

                <div class="form-group">
                    <label class="form-label">–ü—Ä–æ–º–æ–∫–æ–¥ (–µ—Å–ª–∏ –µ—Å—Ç—å)</label>
                    <div style="display:flex;gap:8px">
                        <input type="text" class="form-input" id="promoCodeInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥">
                        <button class="btn btn-primary" onclick="validatePromocode()" style="white-space:nowrap">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                    </div>
                    <div id="promoCodeMessage" style="font-size:12px;margin-top:4px"></div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω *</label>
                    <input type="tel" class="form-input phone-input" id="phoneInput" placeholder="+7 (XXX) XXX-XX-XX" required value="+7">
                    <div class="settings-hint">–£–∫–∞–∂–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–ª—è —Å–≤—è–∑–∏ —Å –≤–∞–º–∏</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–°–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è</label>
                    <div class="delivery-option selected" data-type="pickup" onclick="selectDeliveryOption('pickup')">
                        <div class="delivery-option-header">
                            <i class="fas fa-store"></i>
                            <div class="delivery-option-title">–°–∞–º–æ–≤—ã–≤–æ–∑ –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞</div>
                            <div class="delivery-price">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</div>
                        </div>
                        <div class="delivery-option-description">–ó–∞–±–µ—Ä–∏—Ç–µ –∑–∞–∫–∞–∑ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –≤ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è</div>
                    </div>
                    <div class="delivery-option" data-type="delivery" onclick="selectDeliveryOption('delivery')">
                        <div class="delivery-option-header">
                            <i class="fas fa-truck"></i>
                            <div class="delivery-option-title">–î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º</div>
                            <div class="delivery-price" id="deliveryPriceText">200 ‚ÇΩ</div>
                        </div>
                        <div class="delivery-option-description">–ü—Ä–∏–≤–µ–∑–µ–º –∑–∞–∫–∞–∑ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∞–¥—Ä–µ—Å—É –≤ –Ø—Ä–æ—Å–ª–∞–≤–ª–µ</div>
                    </div>
                </div>

                <div class="form-group" id="addressField" style="display:none">
                    <label class="form-label">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                    <textarea class="form-input" id="deliveryAddress" placeholder="–£–∫–∞–∂–∏—Ç–µ –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏: —É–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞..." rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É</label>
                    <textarea class="form-input" id="orderComment" placeholder="–û—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è, –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–∫–∞–∑–∞–Ω–∏—è..." rows="3"></textarea>
                </div>
                
                <div class="form-actions" style="margin-top:20px">
                    <button class="checkout-btn" id="confirmOrderBtn" onclick="submitOrder()" disabled>
                        <i class="fas fa-paper-plane"></i> –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                    </button>
                </div>
            </div>

            <div id="orderSuccess" style="display:none">
                <div class="success-state">
                    <div class="success-icon">üéâ</div>
                    <div class="success-title">–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω!</div>
                    <div class="success-message">
                        –í–∞—à –∑–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É. –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞.
                    </div>
                    <button class="checkout-btn" onclick="closeOrderSuccess()">
                        <i class="fas fa-shopping-bag"></i> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="editProductModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title"><i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</div>
                <button class="close-modal" id="closeEditProduct">√ó</button>
            </div>
            <div id="editProductForm">
                <input type="hidden" id="editProductId">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                    <input type="text" class="form-input" id="editProductName">
                </div>
                <div class="form-group">
                    <label class="form-label">–¶–µ–Ω–∞</label>
                    <input type="number" class="form-input" id="editProductPrice">
                </div>
                <div class="form-group">
                    <label class="form-label">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
                    <input type="text" class="form-input" id="editProductImage">
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select class="form-input" id="editProductCategory">
                        <option value="roses">–†–æ–∑—ã</option>
                        <option value="tulips">–¢—é–ª—å–ø–∞–Ω—ã</option>
                        <option value="orchids">–û—Ä—Ö–∏–¥–µ–∏</option>
                        <option value="premium">–ü—Ä–µ–º–∏—É–º –±—É–∫–µ—Ç—ã</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea class="form-input" id="editProductDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç</label>
                    <textarea class="form-input" id="editProductFact" rows="2"></textarea>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="editProductAvailable" checked>
                    <label class="checkbox-label">–¢–æ–≤–∞—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–∫–∞–∑–∞</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="editProductFeatured">
                    <label class="checkbox-label">–•–∏—Ç —Ç–æ–≤–∞—Ä (–±–µ–π–¥–∂ "–•–∏—Ç")</label>
                </div>
                <button class="checkout-btn" onclick="updateProduct()">
                    <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                </button>
            </div>
        </div>
    </div>

    <script>
        let tg=window.Telegram.WebApp;tg.expand();tg.ready();
        let cart=[];let currentCategory='all';let products=[];let isAdmin=false;let currentUserRole='';
        let adminData={products:[],orders:[],admins:[],stats:{},settings:{},themes:[],promocodes:[]};
        let deliveryOption='pickup';let deliveryPrice=200;let freeDeliveryMin=3000;
        let currentOrdersPage=1;let ordersPerPage=10;
        let appliedPromocode=null;

        function showToast(message,type='success'){const toast=document.getElementById('toast');const toastMessage=document.getElementById('toastMessage');const toastIcon=document.getElementById('toastIcon');toastMessage.textContent=message;toast.className='toast';toast.classList.add(type);if(type==='success'){toastIcon.className='fas fa-check-circle'}else if(type==='error'){toastIcon.className='fas fa-times-circle'}else{toastIcon.className='fas fa-info-circle'}toast.classList.add('show');setTimeout(()=>{toast.classList.remove('show')},2000)}

        async function loadProducts(){try{const response=await fetch('/api/products');if(!response.ok)throw new Error('Network error');products=await response.json();renderProducts()}catch(error){console.error('Error loading products:',error);showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–∞–ª–æ–≥–∞','error');renderProducts([])}}

        function filterByCategory(category){currentCategory=category;document.querySelectorAll('.category-btn').forEach(btn=>btn.classList.remove('active'));event.target.classList.add('active');renderProducts(category);tg.HapticFeedback.selectionChanged()}

        function renderProducts(category='all'){const grid=document.getElementById('productsGrid');if(products.length===0){grid.innerHTML='<div class="loading"><div>–¢–æ–≤–∞—Ä—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã</div></div>';return}grid.innerHTML='';const filteredProducts=category==='all'?products:products.filter(product=>product.category===category);if(filteredProducts.length===0){grid.innerHTML='<div class="loading"><div>–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</div></div>';return}filteredProducts.forEach(product=>{const productCard=document.createElement('div');productCard.className='product-card';productCard.innerHTML=`<div class="product-image"><img src="${product.image_url}" alt="${product.name}" loading="lazy" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0yMDAgMTUwQzIyNSAyMDAgMjUwIDE1MCAyMDAgMTAwQzE1MCAxNTAgMTc1IDIwMCAyMDAgMTUwWiIgZmlsbD0iI0U1RTVFNSIvPgo8L3N2Zz4K'">${product.is_featured?'<div class="product-badge">–•–∏—Ç</div>':''}</div><div class="product-content"><div class="product-title">${product.name}</div><div class="product-description">${product.description}</div>${product.fact?`<div class="product-fact"><i class="fas fa-lightbulb"></i><span class="product-fact-text">${product.fact}</span></div>`:''}<div class="product-footer"><div class="product-price">${product.price.toLocaleString()} ‚ÇΩ</div><button class="add-to-cart" data-id="${product.id}"><i class="fas fa-plus"></i>–í –∫–æ—Ä–∑–∏–Ω—É</button></div></div>`;grid.appendChild(productCard)});document.querySelectorAll('.add-to-cart').forEach(button=>{button.addEventListener('click',(e)=>{const productId=parseInt(e.target.closest('.add-to-cart').dataset.id);addToCart(productId)})});document.querySelectorAll('.product-fact').forEach(fact=>{fact.addEventListener('click',function(){const icon=this.querySelector('i');icon.style.color='#fbbf24';icon.style.textShadow='0 0 10px #f59e0b, 0 0 20px #f59e0b';icon.style.transform='scale(1.1)';setTimeout(()=>{icon.style.color='#f59e0b';icon.style.textShadow='none';icon.style.transform='scale(1)'},1000)})})}

        function addToCart(productId){const product=products.find(p=>p.id===productId);if(product){const existingItem=cart.find(item=>item.id===productId);if(existingItem){existingItem.quantity+=1}else{cart.push({...product,quantity:1})}updateCartDisplay();tg.HapticFeedback.impactOccurred('soft');showToast('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É','success')}}

        function updateCartDisplay(){const cartButton=document.getElementById('cartButton');const cartCount=document.getElementById('cartCount');const cartTotalAmount=document.getElementById('cartTotalAmount');const totalItems=cart.reduce((sum,item)=>sum+item.quantity,0);const totalAmount=cart.reduce((sum,item)=>sum+(item.price*item.quantity),0);cartCount.textContent=totalItems;cartTotalAmount.textContent=totalAmount.toLocaleString()+' ‚ÇΩ';if(totalItems>0){cartButton.style.display='flex'}else{cartButton.style.display='none'}renderCartItems();updateOrderSummary()}

        function renderCartItems(){const cartItems=document.getElementById('cartItems');const modalTotal=document.getElementById('modalTotal');const totalAmount=cart.reduce((sum,item)=>sum+(item.price*item.quantity),0);modalTotal.textContent=totalAmount.toLocaleString()+' ‚ÇΩ';if(cart.length===0){cartItems.innerHTML='<div class="empty-cart"><i class="fas fa-shopping-bag"></i><div>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div></div>';return}cartItems.innerHTML='';cart.forEach((item,index)=>{const cartItem=document.createElement('div');cartItem.className='cart-item';cartItem.innerHTML=`<div class="item-info"><div class="item-name">${item.name}</div><div class="item-price">${item.price.toLocaleString()} ‚ÇΩ</div></div><div class="item-actions"><div class="quantity-controls"><button class="quantity-btn" data-index="${index}" data-action="decrease">-</button><span class="quantity">${item.quantity}</span><button class="quantity-btn" data-index="${index}" data-action="increase">+</button></div><button class="remove-item" data-index="${index}"><i class="fas fa-trash"></i></button></div>`;cartItems.appendChild(cartItem)});document.querySelectorAll('.quantity-btn').forEach(button=>{button.addEventListener('click',(e)=>{const index=parseInt(e.target.closest('.quantity-btn').dataset.index);const action=e.target.closest('.quantity-btn').dataset.action;updateQuantity(index,action)})});document.querySelectorAll('.remove-item').forEach(button=>{button.addEventListener('click',(e)=>{const index=parseInt(e.target.closest('.remove-item').dataset.index);removeFromCart(index)})})}

        function updateQuantity(index,action){if(action==='increase'){cart[index].quantity+=1}else if(action==='decrease'){if(cart[index].quantity>1){cart[index].quantity-=1}else{removeFromCart(index);return}}updateCartDisplay();tg.HapticFeedback.selectionChanged()}

        function removeFromCart(index){const removedItem=cart[index];cart.splice(index,1);updateCartDisplay();tg.HapticFeedback.impactOccurred('light');showToast('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã','error')}

        function showCartModal(){document.getElementById('cartModal').style.display='flex'}

        function selectDeliveryOption(option){deliveryOption=option;document.querySelectorAll('.delivery-option').forEach(el=>{el.classList.remove('selected')});document.querySelector(`.delivery-option[data-type="${option}"]`).classList.add('selected');const addressField=document.getElementById('addressField');if(option==='delivery'){addressField.style.display='block'}else{addressField.style.display='none'}updateOrderSummary()}

        function updateOrderSummary(){const cartTotal=cart.reduce((sum,item)=>sum+(item.price*item.quantity),0);let finalTotal=cartTotal;let deliveryCost=0;let deliveryText='';if(deliveryOption==='delivery'){deliveryCost=cartTotal>=freeDeliveryMin?0:deliveryPrice;finalTotal=cartTotal+deliveryCost;deliveryText=deliveryCost>0?`${deliveryCost} ‚ÇΩ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ –æ—Ç ${freeDeliveryMin} ‚ÇΩ)`:'–ë–µ—Å–ø–ª–∞—Ç–Ω–æ'}else{deliveryText='–ë–µ—Å–ø–ª–∞—Ç–Ω–æ'}if(appliedPromocode){finalTotal-=appliedPromocode.discount_amount}const summaryContent=document.getElementById('orderSummaryContent');if(summaryContent){summaryContent.innerHTML=cart.map(item=>`<div class="summary-row"><span>${item.name} √ó ${item.quantity}</span><span>${(item.price*item.quantity).toLocaleString()} ‚ÇΩ</span></div>`).join('')+`<div class="summary-row"><span>–î–æ—Å—Ç–∞–≤–∫–∞</span><span>${deliveryText}</span></div>`+(appliedPromocode?`<div class="summary-row"><span>–°–∫–∏–¥–∫–∞ –ø–æ –ø—Ä–æ–º–æ–∫–æ–¥—É</span><span>-${appliedPromocode.discount_amount} ‚ÇΩ</span></div>`:'')+`<div class="summary-row total"><span>–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ</span><span>${finalTotal.toLocaleString()} ‚ÇΩ</span></div>`}}

        function validatePhone(phone){const phoneRegex=/^(\+7|8)[\s\-]?\(?[489][0-9]{2}\)?[\s\-]?[0-9]{3}[\s\-]?[0-9]{2}[\s\-]?[0-9]{2}$/;return phoneRegex.test(phone.replace(/\s/g,''))}

        async function validatePromocode(){const code=document.getElementById('promoCodeInput').value;const cartTotal=cart.reduce((sum,item)=>sum+(item.price*item.quantity),0);if(!code){showToast('–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥','error');return}try{const response=await fetch('/api/promocodes',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'validate',code:code,order_amount:cartTotal})});const result=await response.json();if(result.valid){appliedPromocode=result;document.getElementById('promoCodeMessage').textContent=`‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω! –°–∫–∏–¥–∫–∞: ${result.discount_amount}‚ÇΩ`;document.getElementById('promoCodeMessage').style.color='green';updateOrderSummary();showToast('–ü—Ä–æ–º–æ–∫–æ–¥ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω—ë–Ω','success')}else{document.getElementById('promoCodeMessage').textContent=`‚ùå ${result.error}`;document.getElementById('promoCodeMessage').style.color='red';appliedPromocode=null;updateOrderSummary()}}catch(error){console.error('Error validating promocode:',error);showToast('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–º–æ–∫–æ–¥–∞','error')}}

        function showOrderModal(){if(cart.length===0){tg.showAlert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞.');return}document.getElementById('cartModal').style.display='none';document.getElementById('orderModal').style.display='flex';updateOrderSummary()}

        function submitOrder(){const phone=document.getElementById('phoneInput').value;const comment=document.getElementById('orderComment').value;const deliveryAddress=deliveryOption==='delivery'?document.getElementById('deliveryAddress').value:'';if(deliveryOption==='delivery'&&!deliveryAddress.trim()){tg.showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏.');return}if(!validatePhone(phone)){tg.showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.');return}const cartTotal=cart.reduce((sum,item)=>sum+(item.price*item.quantity),0);let finalTotal=cartTotal;if(deliveryOption==='delivery'){finalTotal+=cartTotal>=freeDeliveryMin?0:deliveryPrice}if(appliedPromocode){finalTotal-=appliedPromocode.discount_amount}const orderData={user:{id:tg.initDataUnsafe.user?.id||'–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',first_name:tg.initDataUnsafe.user?.first_name||'–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',username:tg.initDataUnsafe.user?.username||'–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'},phone:phone,comment:comment,delivery_option:deliveryOption,delivery_address:deliveryAddress,items:cart.map(item=>({id:item.id,name:item.name,price:item.price,quantity:item.quantity,total:item.price*item.quantity})),total:finalTotal,promocode_id:appliedPromocode?.promocode_id||null,discount_amount:appliedPromocode?.discount_amount||0,time:new Date().toLocaleString('ru-RU')};document.getElementById('confirmOrderBtn').disabled=true;document.getElementById('confirmOrderBtn').innerHTML='<i class="fas fa-spinner fa-spin"></i> –û—Ç–ø—Ä–∞–≤–ª—è–µ–º...';sendOrderToAdmin(orderData).then(success=>{if(success){showOrderSuccess()}}).catch(error=>{document.getElementById('confirmOrderBtn').disabled=false;document.getElementById('confirmOrderBtn').innerHTML='<i class="fas fa-paper-plane"></i> –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑'})}

        function sendOrderToAdmin(orderData){return fetch('/api/order',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(orderData)}).then(response=>response.json()).then(data=>{if(data.success){return true}else{tg.showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞.');return false}}).catch(error=>{console.error('Error:',error);tg.showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞.');return false})}

        function showOrderSuccess(){document.getElementById('orderForm').style.display='none';document.getElementById('orderSuccess').style.display='block'}

        function closeOrderSuccess(){document.getElementById('orderModal').style.display='none';cart=[];appliedPromocode=null;updateCartDisplay();document.getElementById('orderForm').style.display='block';document.getElementById('orderSuccess').style.display='none';document.getElementById('phoneInput').value='+7';document.getElementById('orderComment').value='';document.getElementById('deliveryAddress').value='';document.getElementById('promoCodeInput').value='';document.getElementById('promoCodeMessage').textContent='';document.getElementById('confirmOrderBtn').disabled=true;document.getElementById('confirmOrderBtn').innerHTML='<i class="fas fa-paper-plane"></i> –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑';selectDeliveryOption('pickup')}

        function setupEventListeners(){document.getElementById('closeCart').addEventListener('click',()=>{document.getElementById('cartModal').style.display='none'});document.getElementById('closeOrder').addEventListener('click',()=>{document.getElementById('orderModal').style.display='none'});document.getElementById('closeEditProduct').addEventListener('click',()=>{document.getElementById('editProductModal').style.display='none'});document.getElementById('phoneInput').addEventListener('input',function(e){const phone=e.target.value;const isValid=validatePhone(phone);document.getElementById('confirmOrderBtn').disabled=!isValid;if(phone&&!isValid){this.style.borderColor='#ef4444'}else{this.style.borderColor=isValid?'#22c55e':'#e5e7eb'}});document.querySelectorAll('.modal').forEach(modal=>{modal.addEventListener('click',(e)=>{if(e.target===modal){modal.style.display='none'}})});const phoneInput=document.getElementById('phoneInput');phoneInput.addEventListener('input',function(e){let value=e.target.value.replace(/\D/g,'');if(value.startsWith('7')||value.startsWith('8')){value=value.substring(1)}if(value.length>0){value='+7 ('+value;if(value.length>7){value=value.substring(0,7)+') '+value.substring(7)}if(value.length>12){value=value.substring(0,12)+'-'+value.substring(12)}if(value.length>15){value=value.substring(0,15)+'-'+value.substring(15)}}e.target.value=value});document.getElementById('promoDiscountType').addEventListener('change',function(){const suffix=document.getElementById('promoDiscountSuffix');suffix.textContent=this.value==='percentage'?'%':'‚ÇΩ'});document.querySelectorAll('.help-tab').forEach(tab=>{tab.addEventListener('click',function(){document.querySelectorAll('.help-tab').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.help-section').forEach(s=>s.classList.remove('active'));this.classList.add('active');const helpSection=this.dataset.help;document.getElementById(helpSection+'Help').classList.add('active')})})}

        async function checkAdminAccess(){try{const telegramId=String(tg.initDataUnsafe.user?.id||'');const response=await fetch('/api/admin',{headers:{'Telegram-Id':telegramId}});const data=await response.json();isAdmin=data.is_admin===true&&data.is_active!==false;currentUserRole=data.role||'';if(isAdmin){document.getElementById('adminButton').style.display='flex';if(currentUserRole==='owner'){document.getElementById('dangerousTab').style.display='flex';document.getElementById('promoFormContainer').style.display='block';document.getElementById('adminFormContainer').style.display='block'}}}catch(error){console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–¥–º–∏–Ω-–¥–æ—Å—Ç—É–ø–∞:',error)}}

        function switchToCustomerView(){document.getElementById('adminPanel').style.display='none';document.getElementById('customerView').style.display='block';document.getElementById('helpView').style.display='none';document.getElementById('adminButton').style.display=isAdmin?'flex':'none'}

        function switchToAdminView(){if(!isAdmin){showToast('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è','error');return}document.getElementById('customerView').style.display='none';document.getElementById('adminPanel').style.display='block';document.getElementById('helpView').style.display='none';document.getElementById('adminButton').style.display='none';setTimeout(()=>{setupAdminTabs();loadAdminData()},100)}

        function showHelp(){document.getElementById('customerView').style.display='none';document.getElementById('adminPanel').style.display='none';document.getElementById('helpView').style.display='block';document.getElementById('adminButton').style.display=isAdmin?'flex':'none'}

        function setupAdminTabs(){document.querySelectorAll('.admin-tab').forEach(tab=>{tab.onclick=null});document.querySelectorAll('.admin-tab').forEach(tab=>{tab.addEventListener('click',function(){document.querySelectorAll('.admin-tab').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.admin-tab-content').forEach(c=>c.classList.remove('active'));this.classList.add('active');const tabName=this.dataset.tab;const contentId=tabName+'Tab';const contentElement=document.getElementById(contentId);if(contentElement){contentElement.classList.add('active');switch(tabName){case'dashboard':loadDashboard();break;case'products':loadProductsAdmin();break;case'orders':loadOrdersAdmin();break;case'promocodes':loadPromocodes();break;case'admins':loadAdmins();break;case'settings':loadSettings();break}}})});const firstTab=document.querySelector('.admin-tab[data-tab="dashboard"]');if(firstTab){firstTab.click()}}

        function showTab(tabName){document.querySelectorAll('.admin-tab').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.admin-tab-content').forEach(c=>c.classList.remove('active'));document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');document.getElementById(tabName+'Tab').classList.add('active');if(tabName==='dashboard')loadDashboard();if(tabName==='products')loadProductsAdmin();if(tabName==='orders')loadOrdersAdmin();if(tabName==='promocodes')loadPromocodes();if(tabName==='admins')loadAdmins();if(tabName==='settings')loadSettings()}

        async function loadAdminData(){await loadDashboard();await loadProductsAdmin();await loadOrdersAdmin();await loadPromocodes();await loadAdmins();await loadSettings()}

        async function loadDashboard(){try{const response=await fetch('/api/admin/stats');const stats=await response.json();document.getElementById('totalOrders').textContent=stats.total_orders;document.getElementById('completedOrders').textContent=stats.completed_orders;document.getElementById('totalRevenue').textContent=stats.total_revenue.toLocaleString()+' ‚ÇΩ';document.getElementById('potentialRevenue').textContent=stats.potential_revenue.toLocaleString()+' ‚ÇΩ';document.getElementById('totalProducts').textContent=stats.total_products;document.getElementById('activePromocodes').textContent=stats.active_promocodes||0}catch(error){console.error('Error loading dashboard:',error)}}

        async function loadProductsAdmin(){try{const response=await fetch('/api/products');const products=await response.json();adminData.products=products;renderProductsAdmin(products)}catch(error){console.error('Error loading products admin:',error)}}

        function renderProductsAdmin(products){const productsList=document.getElementById('productsList');productsList.innerHTML='';if(products.length===0){productsList.innerHTML='<div class="empty-table-message">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';return}products.forEach((product,index)=>{const row=document.createElement('div');row.className='table-row';row.setAttribute('data-id',product.id);row.innerHTML=`<div class="move-buttons"><button class="move-btn" onclick="moveProductUp(${product.id})" ${index===0?'disabled':''}><i class="fas fa-chevron-up"></i></button><button class="move-btn" onclick="moveProductDown(${product.id})" ${index===products.length-1?'disabled':''}><i class="fas fa-chevron-down"></i></button></div><div><strong>${product.name}</strong><div style="font-size:11px;color:var(--text-light)">${product.description}</div></div><div>${product.price} ‚ÇΩ</div><div>${product.category}</div><div class="admin-actions"><button class="btn btn-primary btn-sm" onclick="editProduct(${product.id})" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"><i class="fas fa-edit fa-lg"></i></button><button class="btn btn-danger btn-sm" onclick="deleteProduct(${product.id})" title="–£–¥–∞–ª–∏—Ç—å"><i class="fas fa-trash fa-lg"></i></button></div>`;productsList.appendChild(row)})}

        async function moveProductUp(productId){const products=adminData.products;const index=products.findIndex(p=>p.id===productId);if(index>0){[products[index],products[index-1]]=[products[index-1],products[index]];await updateProductsOrder();loadProductsAdmin()}}

        async function moveProductDown(productId){const products=adminData.products;const index=products.findIndex(p=>p.id===productId);if(index<products.length-1){[products[index],products[index+1]]=[products[index+1],products[index]];await updateProductsOrder();loadProductsAdmin()}}

        async function updateProductsOrder(){const productsOrder={};adminData.products.forEach((product,index)=>{productsOrder[product.id]=index+1});try{const response=await fetch('/api/products',{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({reorder:productsOrder})});const result=await response.json();if(result.success){showToast('–ü–æ—Ä—è–¥–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω','success')}}catch(error){console.error('Error updating products order:',error);showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞','error')}}

        async function loadOrdersAdmin(){try{const response=await fetch('/api/order',{headers:{'Is-Admin':'true','User-Id':tg.initDataUnsafe.user?.id||''}});const orders=await response.json();adminData.orders=orders;renderOrdersAdmin(orders)}catch(error){console.error('Error loading orders admin:',error)}}

        function renderOrdersAdmin(orders){const ordersList=document.getElementById('ordersList');const pagination=document.getElementById('ordersPagination');ordersList.innerHTML='';if(orders.length===0){ordersList.innerHTML='<div class="empty-table-message">–ó–∞–∫–∞–∑—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';pagination.innerHTML='';return}const statusNames={1:{name:'–ù–æ–≤—ã–π',color:'#EF4444',class:'new'},2:{name:'–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω',color:'#F59E0B',class:'confirmed'},3:{name:'–°–æ–±–∏—Ä–∞–µ—Ç—Å—è',color:'#8B5CF6',class:'confirmed'},4:{name:'–í –ø—É—Ç–∏',color:'#3B82F6',class:'confirmed'},5:{name:'–î–æ—Å—Ç–∞–≤–ª–µ–Ω',color:'#10B981',class:'delivered'},6:{name:'–û—Ç–º–µ–Ω–µ–Ω',color:'#6B7280',class:'cancelled'}};const startIndex=(currentOrdersPage-1)*ordersPerPage;const endIndex=startIndex+ordersPerPage;const paginatedOrders=orders.slice(startIndex,endIndex);paginatedOrders.forEach(order=>{const status=statusNames[order.status_id]||{name:'–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω',color:'#6B7280',class:'new'};const telegramLink=`tg://openmessage?user_id=${order.user_id}`;const phoneLink=`https://t.me/+${order.phone.replace(/\D/g,'')}`;const row=document.createElement('div');row.className='table-row';row.innerHTML=`<div>#${order.id}</div><div><strong>${order.user_name}</strong><div style="font-size:11px;color:var(--text-light)">${order.phone}</div></div><div><strong>${order.final_amount||order.total_amount} ‚ÇΩ</strong></div><div><span class="badge ${status.class}">${status.name}</span></div><div class="admin-actions"><button class="contact-btn" onclick="window.open('${telegramLink}')" title="–ù–∞–ø–∏—Å–∞—Ç—å –ø–æ ID"><i class="fas fa-user fa-sm"></i></button><button class="contact-btn" onclick="window.open('${phoneLink}')" title="–ù–∞–ø–∏—Å–∞—Ç—å –ø–æ –Ω–æ–º–µ—Ä—É"><i class="fas fa-phone fa-sm"></i></button><button class="btn btn-primary btn-sm" onclick="changeOrderStatus(${order.id})" title="–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å"><i class="fas fa-edit fa-lg"></i></button><button class="btn btn-danger btn-sm" onclick="deleteOrder(${order.id})" title="–£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑"><i class="fas fa-trash fa-lg"></i></button></div>`;ordersList.appendChild(row)});const totalPages=Math.ceil(orders.length/ordersPerPage);pagination.innerHTML='';for(let i=1;i<=totalPages;i++){const pageBtn=document.createElement('button');pageBtn.className=`page-btn ${i===currentOrdersPage?'active':''}`;pageBtn.textContent=i;pageBtn.onclick=()=>{currentOrdersPage=i;renderOrdersAdmin(adminData.orders)};pagination.appendChild(pageBtn)}}

        async function loadPromocodes(){try{const response=await fetch('/api/promocodes',{headers:{'Telegram-Id':tg.initDataUnsafe.user?.id||''}});const promocodes=await response.json();adminData.promocodes=promocodes;renderPromocodes(promocodes)}catch(error){console.error('Error loading promocodes:',error)}}

        function renderPromocodes(promocodes){const promocodesList=document.getElementById('promocodesList');promocodesList.innerHTML='';if(promocodes.length===0){promocodesList.innerHTML='<div class="empty-table-message">–ü—Ä–æ–º–æ–∫–æ–¥—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';return}promocodes.forEach(promo=>{const row=document.createElement('div');row.className='table-row';row.innerHTML=`<div><strong>${promo.code}</strong></div><div class="promo-discount">${promo.discount_value}${promo.discount_type==='percentage'?'%':'‚ÇΩ'}</div><div>${promo.used_count||0}/${promo.max_uses||'‚àû'}</div><div><span class="badge ${promo.is_active?'delivered':'cancelled'}">${promo.is_active?'–ê–∫—Ç–∏–≤–µ–Ω':'–ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}</span></div><div>${currentUserRole==='owner'?`<button class="btn btn-danger btn-sm" onclick="deletePromocode(${promo.id})"><i class="fas fa-trash"></i></button>`:'-'}</div>`;promocodesList.appendChild(row)})}

        async function loadAdmins(){try{const response=await fetch('/api/admin/admins');const admins=await response.json();adminData.admins=admins;renderAdmins(admins)}catch(error){console.error('Error loading admins:',error)}}

        function renderAdmins(admins){const adminsList=document.getElementById('adminsList');adminsList.innerHTML='';if(admins.length===0){adminsList.innerHTML='<div class="empty-table-message">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';return}admins.forEach(admin=>{const row=document.createElement('div');row.className='table-row';row.innerHTML=`<div>${admin.id}</div><div>${admin.first_name}</div><div>@${admin.username}</div><div><span class="role-badge ${admin.role==='owner'?'role-owner':'role-admin'}">${admin.role==='owner'?'–í–ª–∞–¥–µ–ª–µ—Ü':'–ê–¥–º–∏–Ω'}</span></div><div>${admin.role!=='owner'&&currentUserRole==='owner'?`<button class="btn btn-danger btn-sm" onclick="deleteAdmin(${admin.id})"><i class="fas fa-trash"></i></button>`:'<span style="color:var(--text-light);font-size:10px">–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å</span>'}</div>`;adminsList.appendChild(row)})}

        async function loadSettings(){try{const response=await fetch('/api/admin/settings');const settings=await response.json();adminData.settings=settings;document.getElementById('shopNameInput').value=settings.shop_name?.value||'üå∏ Flower Shop';document.getElementById('shopPhone').value=settings.contacts?.phone||'+7 (999) 123-45-67';document.getElementById('shopAddress').value=settings.contacts?.address||'–Ø—Ä–æ—Å–ª–∞–≤–ª—å, —É–ª. –¶–≤–µ—Ç–æ—á–Ω–∞—è, 15';document.getElementById('shopWorkingHours').value=settings.working_hours?.value||'–ï–∂–µ–¥–Ω–µ–≤–Ω–æ —Å 9:00 –¥–æ 21:00';document.getElementById('deliveryPrice').value=settings.delivery_price?.value||200;document.getElementById('freeDeliveryMin').value=settings.free_delivery_min?.value||3000;deliveryPrice=settings.delivery_price?.value||200;freeDeliveryMin=settings.free_delivery_min?.value||3000;updateShopHeader();const themesResponse=await fetch('/api/admin/themes');const themes=await themesResponse.json();adminData.themes=themes;renderThemes(themes,settings.active_theme?.value||'1')}catch(error){console.error('Error loading settings:',error)}}

        function renderThemes(themes,activeThemeId){const themeGrid=document.getElementById('themeGrid');themeGrid.innerHTML='';themes.forEach(theme=>{const themeOption=document.createElement('div');themeOption.className=`theme-option ${theme.id==activeThemeId?'selected':''}`;themeOption.style.background=theme.background_value;themeOption.onclick=()=>selectTheme(theme.id);themeGrid.appendChild(themeOption)})}

        function selectTheme(themeId){fetch('/api/admin',{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({theme_id:themeId})}).then(response=>response.json()).then(result=>{if(result.success){document.querySelectorAll('.theme-option').forEach(opt=>opt.classList.remove('selected'));event.target.classList.add('selected');applyTheme(themeId);showToast('–¢–µ–º–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞','success')}}).catch(error=>{console.error('Error selecting theme:',error);showToast('–û—à–∏–±–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã','error')})}

        function applyTheme(themeId){const theme=adminData.themes.find(t=>t.id==themeId);if(theme){document.documentElement.style.setProperty('--header-bg',theme.background_value);document.getElementById('shopHeader').style.background=theme.background_value;document.body.style.background=theme.background_value}}

        function updateShopHeader(){document.getElementById('shopName').textContent=document.getElementById('shopNameInput').value;document.getElementById('deliveryInfoText').textContent=`–î–æ—Å—Ç–∞–≤–∫–∞ ${deliveryPrice}‚ÇΩ ‚Ä¢ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –æ—Ç ${freeDeliveryMin}‚ÇΩ`;document.getElementById('workingHoursText').textContent=document.getElementById('shopWorkingHours').value;document.getElementById('deliveryPriceText').textContent=`${deliveryPrice} ‚ÇΩ`}

        function toggleProductForm(){const content=document.getElementById('productFormContent');const icon=document.getElementById('productFormIcon');content.classList.toggle('expanded');icon.style.transform=content.classList.contains('expanded')?'rotate(180deg)':'rotate(0deg)'}

        async function addProduct(){const product={name:document.getElementById('productName').value,price:parseInt(document.getElementById('productPrice').value),image_url:document.getElementById('productImage').value,category:document.getElementById('productCategory').value,description:document.getElementById('productDescription').value,fact:document.getElementById('productFact').value,is_available:true,is_featured:document.getElementById('productFeatured').checked};if(!product.name||!product.price){showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω—É','error');return}try{const response=await fetch('/api/products',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(product)});const result=await response.json();if(result.success){showToast('–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω','success');loadProductsAdmin();resetProductForm();loadProducts()}}catch(error){console.error('Error adding product:',error);showToast('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞','error')}}

        async function addPromocode(){const promoData={code:document.getElementById('promoCode').value,discount_type:document.getElementById('promoDiscountType').value,discount_value:parseInt(document.getElementById('promoDiscountValue').value),min_order_amount:parseInt(document.getElementById('promoMinOrder').value)||0,max_uses:document.getElementById('promoMaxUses').value?parseInt(document.getElementById('promoMaxUses').value):null,valid_until:document.getElementById('promoValidUntil').value||null};if(!promoData.code||!promoData.discount_value){showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–¥ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–∫–∏–¥–∫–∏','error');return}try{const response=await fetch('/api/promocodes',{method:'POST',headers:{'Content-Type':'application/json','Telegram-Id':tg.initDataUnsafe.user?.id||''},body:JSON.stringify(promoData)});const result=await response.json();if(result.success){showToast('–ü—Ä–æ–º–æ–∫–æ–¥ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω','success');loadPromocodes();resetPromoForm()}}catch(error){console.error('Error adding promocode:',error);showToast('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞','error')}}

        async function editProduct(productId){const product=adminData.products.find(p=>p.id===productId);if(!product)return;document.getElementById('editProductId').value=product.id;document.getElementById('editProductName').value=product.name;document.getElementById('editProductPrice').value=product.price;document.getElementById('editProductImage').value=product.image_url;document.getElementById('editProductCategory').value=product.category;document.getElementById('editProductDescription').value=product.description||'';document.getElementById('editProductFact').value=product.fact||'';document.getElementById('editProductAvailable').checked=product.is_available;document.getElementById('editProductFeatured').checked=product.is_featured||false;document.getElementById('editProductModal').style.display='flex'}

        async function updateProduct(){const productId=document.getElementById('editProductId').value;const product={name:document.getElementById('editProductName').value,price:parseInt(document.getElementById('editProductPrice').value),image_url:document.getElementById('editProductImage').value,category:document.getElementById('editProductCategory').value,description:document.getElementById('editProductDescription').value,fact:document.getElementById('editProductFact').value,is_available:document.getElementById('editProductAvailable').checked,is_featured:document.getElementById('editProductFeatured').checked};try{const response=await fetch('/api/products',{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({...product,id:parseInt(productId)})});const result=await response.json();if(result.success){showToast('–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω','success');document.getElementById('editProductModal').style.display='none';loadProductsAdmin();loadProducts()}}catch(error){console.error('Error updating product:',error);showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞','error')}}

        async function deleteProduct(productId){if(!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?'))return;try{const response=await fetch(`/api/products/${productId}`,{method:'DELETE'});const result=await response.json();if(result.success){showToast('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω','success');loadProductsAdmin();loadProducts()}}catch(error){console.error('Error deleting product:',error);showToast('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞','error')}}

        async function deletePromocode(promocodeId){if(!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥?'))return;try{const response=await fetch(`/api/promocodes/${promocodeId}`,{method:'DELETE',headers:{'Telegram-Id':tg.initDataUnsafe.user?.id||''}});const result=await response.json();if(result.success){showToast('–ü—Ä–æ–º–æ–∫–æ–¥ —É–¥–∞–ª–µ–Ω','success');loadPromocodes()}}catch(error){console.error('Error deleting promocode:',error);showToast('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞','error')}}

        function changeOrderStatus(orderId){const newStatus=prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å (1-6):\n1 - –ù–æ–≤—ã–π\n2 - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω\n3 - –°–æ–±–∏—Ä–∞–µ—Ç—Å—è\n4 - –í –ø—É—Ç–∏\n5 - –î–æ—Å—Ç–∞–≤–ª–µ–Ω\n6 - –û—Ç–º–µ–Ω–µ–Ω');if(newStatus&&newStatus>=1&&newStatus<=6){updateOrderStatus(orderId,parseInt(newStatus))}}

        async function updateOrderStatus(orderId,statusId){try{const response=await fetch('/api/order',{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({order_id:parseInt(orderId),status_id:parseInt(statusId)})});const result=await response.json();if(result.success){showToast('–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω','success');loadOrdersAdmin()}}catch(error){console.error('Error updating order status:',error);showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞','error')}}

        async function deleteOrder(orderId){if(!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∑–∞–∫–∞–∑?'))return;try{const response=await fetch(`/api/order/${orderId}`,{method:'DELETE'});const result=await response.json();if(result.success){showToast('–ó–∞–∫–∞–∑ —É–¥–∞–ª–µ–Ω','success');loadOrdersAdmin()}}catch(error){console.error('Error deleting order:',error);showToast('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞','error')}}

        async function addAdmin(){const admin={telegram_id:document.getElementById('adminTelegramId').value,username:document.getElementById('adminUsername').value.replace('@',''),first_name:document.getElementById('adminFirstName').value,role:document.getElementById('adminRole').value};if(!admin.telegram_id||!admin.first_name){showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è','error');return}try{const response=await fetch('/api/admin',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(admin)});const result=await response.json();if(result.success){showToast('–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –¥–æ–±–∞–≤–ª–µ–Ω','success');loadAdmins();resetAdminForm()}}catch(error){console.error('Error adding admin:',error);showToast('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞','error')}}

        async function deleteAdmin(adminId){if(!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞?'))return;try{const response=await fetch(`/api/admin/${adminId}`,{method:'DELETE'});const result=await response.json();if(result.success){showToast('–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —É–¥–∞–ª–µ–Ω','success');loadAdmins()}}catch(error){console.error('Error deleting admin:',error);showToast('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞','error')}}

        function resetProductForm(){document.getElementById('productName').value='';document.getElementById('productPrice').value='';document.getElementById('productImage').value='';document.getElementById('productDescription').value='';document.getElementById('productFact').value='';document.getElementById('productFeatured').checked=false}

        function resetPromoForm(){document.getElementById('promoCode').value='';document.getElementById('promoDiscountValue').value='';document.getElementById('promoMinOrder').value='';document.getElementById('promoMaxUses').value='';document.getElementById('promoValidUntil').value=''}

        function resetAdminForm(){document.getElementById('adminTelegramId').value='';document.getElementById('adminUsername').value='';document.getElementById('adminFirstName').value=''}

        function filterProducts(){const searchTerm=document.getElementById('productSearch').value.toLowerCase();const filteredProducts=adminData.products.filter(product=>product.name.toLowerCase().includes(searchTerm)||product.description.toLowerCase().includes(searchTerm)||product.category.toLowerCase().includes(searchTerm));renderProductsAdmin(filteredProducts)}

        function filterOrders(){const searchTerm=document.getElementById('orderSearch').value.toLowerCase();const activeFilter=document.querySelector('.filter-btn.active')?.dataset.status||'all';const filteredOrders=adminData.orders.filter(order=>{const matchesSearch=order.user_name.toLowerCase().includes(searchTerm)||order.phone.includes(searchTerm)||order.id.toString().includes(searchTerm);const matchesFilter=activeFilter==='all'||order.status_id.toString()===activeFilter;return matchesSearch&&matchesFilter});renderOrdersAdmin(filteredOrders)}

        async function saveShopSettings(){try{const settings={shop_name:document.getElementById('shopNameInput').value,phone:document.getElementById('shopPhone').value,address:document.getElementById('shopAddress').value,working_hours:document.getElementById('shopWorkingHours').value,delivery_price:parseInt(document.getElementById('deliveryPrice').value),free_delivery_min:parseInt(document.getElementById('freeDeliveryMin').value)};deliveryPrice=settings.delivery_price;freeDeliveryMin=settings.free_delivery_min;const updateData=[{key:'shop_name',value:{value:settings.shop_name}},{key:'contacts',value:{phone:settings.phone,address:settings.address}},{key:'working_hours',value:{value:settings.working_hours}},{key:'delivery_price',value:{value:settings.delivery_price}},{key:'free_delivery_min',value:{value:settings.free_delivery_min}}];let successCount=0;for(const setting of updateData){const response=await fetch('/api/admin',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(setting)});if(response.ok){successCount++}}if(successCount>0){showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã','success');updateShopHeader()}else{showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫','error')}}catch(error){console.error('Error saving settings:',error);showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫','error')}}

        async function dangerousAction(action){let codeInput;let expectedCode;if(action==='reset_orders'){codeInput=document.getElementById('deleteOrdersCode');expectedCode='DELETE_ORDERS'}else if(action==='reset_stats'){codeInput=document.getElementById('resetStatsCode');expectedCode='RESET_STATS'}else if(action==='delete_promocodes'){codeInput=document.getElementById('deletePromocodesCode');expectedCode='DELETE_PROMOCODES'}if(!codeInput.value||codeInput.value!==expectedCode){showToast('–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è','error');return}if(!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!'))return;try{const response=await fetch('/api/dangerous',{method:'POST',headers:{'Content-Type':'application/json','Telegram-Id':tg.initDataUnsafe.user?.id||''},body:JSON.stringify({action:action,confirmation_code:codeInput.value})});const result=await response.json();if(result.success){showToast(result.message,'success');codeInput.value='';loadAdminData()}else{showToast(result.error,'error')}}catch(error){console.error('Error performing dangerous action:',error);showToast('–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏','error')}}

        document.addEventListener('DOMContentLoaded',function(){document.querySelectorAll('.filter-btn').forEach(btn=>{btn.addEventListener('click',function(){document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');filterOrders()})})});

        function initApp(){loadProducts();setupEventListeners();checkAdminAccess();updateCartDisplay();selectDeliveryOption('pickup');loadSettings();}

        if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',initApp)}else{initApp()}
    </script>
</body>
</html>
